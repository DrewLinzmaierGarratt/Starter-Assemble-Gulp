<!doctype html>
<html class="no-js core no-flexbox" lang="en">
<head>
  <meta charset="utf-8">
  <title>Starter Assemble Gulp</title>
  <meta name="description" content="Starter kit for generating webpages with Assemble and Gulp – alpha"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="index, follow">
  <link rel="author" href="https://plus.google.com/+BramdeHaan/posts">
  <script>function featureDetect(){"use strict";document.documentElement.className=document.documentElement.className.replace(/\bno-js\b/g,"")+" js ","querySelector"in document&&"addEventListener"in window&&Array.prototype.forEach&&(document.documentElement.className=document.documentElement.className.replace(/\bcore\b/g,"")+" enhanced ");var a=document.body||document.documentElement,a=a.style;(""==a.webkitFlexWrap||""==a.msFlexWrap||""==a.flexWrap)&&(document.documentElement.className=document.documentElement.className.replace(/\bno-flexbox\b/g,"")+" flexbox ")}featureDetect();</script>
  <link rel="stylesheet" href="assets/css/style.css">
</head>

<div class="container">
  <header id="header">
  <h1>Starter Assemble Gulp</h1>
  <p>Starter kit for generating webpages with Assemble and Gulp – alpha</p>
</header>
  <nav class="nav" id="nav">
  <ul class="nav_list" id="navList">
    <li><a href="#install">Install</a></li>
    <li><a href="#example1">Examples</a></li>
    <li><a href="#resources">Resources</a></li>
  </ul>
</nav>

  <article>
 <p>Assemble with Gulp is at the moment of writing not quite ready for production. When you go to <a href="https://github.com/assemble/gulp-assemble">the repo for gulp-assemble</a> you will be welcomed by a disclaimer. Things like rendering of markdown to html doesn't quite work yet, so better stay with the stable Grunt version for now. However on a small project with a Gulp workflow and markdown rendering not being required, you can give it a try.</p>

<p>The examples here are with using the beta version of Assemble <strong>not</strong> the plugin – <em>gulp-assemble</em>.</p>

<p>After <code>cd my-project</code> and <code>npm init</code> to generate your <code>package.json</code> you can follow the instructions from <a href="https://github.com/assemble/assemble#README.md">the Readme of the repo</a>.</p>

<h4 id="install">Install globally with npm</h4>

<pre><code class="language-bash">
npm i -g assemble@beta
</code></pre>

<h4>Install locally with npm</h4>

<pre class="language-bash"><code class="language-bash">
npm i assemble@beta --save
</code></pre>

<p>Now you want to at least also install the <code>gulp-extname</code> plugin, to be able to dynamically rewrite file-extensions, otherwise your <code>index.hbs</code> will <em>not</em> get the <code>.html</code> extension after doing: <code>assemble</code></p>

<pre><code class="language-bash">
npm i gulp-extname --save-dev
</code></pre>

<p>The current workflow for this alpha version is to have a seperate file for Assemble called <code>assemblefile.js</code>.</p>

<h3 id="example1">Example assemblefile.js</h3>

<pre><code class="language-javascript">
var assemble = require('assemble');
var extname = require('gulp-extname');

assemble.option('layout', 'base');

assemble.partials('src/templates/partials/*.hbs');
assemble.layouts('src/templates/layouts/*.hbs');
assemble.data(['src/data/*.{json,yml}']);

assemble.task('default', function () {
  assemble.src('src/content/**/*.hbs', { layout: 'base' })
    .pipe(extname())
    .pipe(assemble.dest('dist/static/'));
});
</code></pre>

<p>Go to the files in the repo to see about the new syntax in the <code>src/template</code> folder.
Here Assemble generates the <code>index.html</code> file unminified in the <code>dist/static/</code> folder after executing the <code>assemble</code> command on the command-line. Now we can use gulp-plugins to render and watch the <code>Sass</code> into <code>CSS</code>, have vendor prefixes automatically attached, and minify the <code>index.html</code> generated earlier by Assemble. Here I separated them out in tasks, with an added task for deployment to a gh-pages branch (only on the remote), which is generated by the <code>gulp-gh-pages</code> plugin (<em>so good</em>), one can see <a href="http://atelierbram.github.io/Starter-Assemble-Gulp/">the result here</a>.</p>

<pre><code class="language-bash">
npm install --save-dev gulp-gh-pages
// Usage: Define a deploy task in your gulpfile.js (as below) which can be used to push to gh-pages going forward.
</code></pre>

<h3>Example Gulpfile.js</h3>

<pre><code class="language-javascript">
var gulp = require('gulp');
var sass = require('gulp-sass');
var sourcemaps = require('gulp-sourcemaps');
var autoprefixer = require('gulp-autoprefixer');
var htmlmin = require('gulp-htmlmin');

var ghPages = require('gulp-gh-pages');

// Deploy to ghPages on GitHub with gulp deploy
gulp.task('deploy', function() {
  return gulp.src('dist/&#42;&#42;/&#42;')
    .pipe(ghPages());
});

// option Vars
var srcAssets = 'src/assets/';
var distAssets = 'dist/assets/';
var sassOptions = {
  errLogToConsole: true,
  outputStyle: 'compressed'
};

// https://github.com/ai/browserslist#queries
var autoprefixerOptions = {
  browsers: ['last 2 versions', '&gt; 1%', 'Firefox ESR', 'ie &gt;= 9']
};

// minify html
gulp.task('minify', function() {
  return gulp.src('dist/static/&#42;.html')
    .pipe(htmlmin({collapseWhitespace: true}))
    .pipe(gulp.dest('dist'))
});

// a DIY copy task, no need for a plugin with Gulp!
gulp.task('copy-js', function() {
  gulp.src('src/assets/js/&#42;.js')
  .pipe(gulp.dest('dist/assets/js/'));
});

// tasks
gulp.task('sass', function () {
  return gulp
    // Find all `.scss` file from the `assets/sass` folder
    .src(srcSass)
    // Run Sass on those files
    .pipe(sass(sassOptions).on('error', sass.logError))
    .pipe(sourcemaps.write('./maps'))
    .pipe(autoprefixer(autoprefixerOptions))
    .pipe(autoprefixer())
    // write the resulting CSS in the dist-output folder for distribution
    .pipe(gulp.dest(distCss));
});

gulp.task('watch', function() {
  return gulp
    // Watch the Sass src folder for change,
    // and run `sass` task when something happens
    .watch(srcSass, ['sass'])
    // When there is a change,
    // log a message in the console
    .on('change', function(event) {
      console.log('File ' + event.path + ' was ' + event.type + ', running tasks...');
    });
});

gulp.task('default', ['sass', 'watch']);
</code></pre>


<p>In my <code>.bashrc</code> I have aliases defined for the commands which are defined above:</p>

<pre><code class="language-bash">
alias gls="gulp sass"
alias glw="gulp watch"
alias gla="assemble"
alias glm="gulp minify"
alias gld="gulp deploy"
alias glcpjs="gulp copy-js"
</code></pre>

<p>The assemble – and minify-task should ideally be combined into one task, but this has got to do for now.</p>

<h4 id="resources">Resources</h4>

<ul>
<li><a href="https://github.com/assemble/assemble/tree/v0.6.0-dev">Assemble 6.0 dev</a></li>
<li><a href="https://github.com/jonschlinkert/gulp-extname">gulp-extname</a></li>
<li><a href="https://github.com/assemble/gulp-assemble/blob/master/gulpfile.js">example Gulpfile.js</a></li>
<li><a href="https://gist.github.com/jonschlinkert/e2da295ec7ca5d159914">example assemblefile.js</a></li>
<li><a href="http://www.sitepoint.com/simple-gulpy-workflow-sass/">A Simple Gulp’y Workflow For Sass</a></li>
<li><a href="http://ryanchristiani.com/getting-started-with-gulp-and-sass/">Getting started with Gulp and Sass</a></li>
<li><a href="http://stefanimhoff.de/2014/gulp-tutorial-4-css-generation-sass/">Introduction to Gulp.js 4: Creating CSS with Sass</a></li>
</ul>

</article>


  <footer><small><a href="http://atelierbramdehaan.nl/">Atelier Bram de Haan</a> &middot; <a href="http://atelierbram.mit-license.org/">&copy; 2015</a> &middot; <a href="https://github.com/atelierbram/Starter-Assemble-Gulp">on GitHub</a></small></footer>
</div>

<script src="assets/js/prism-js-bash.js" defer></script>
</html>